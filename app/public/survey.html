<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Hello Bulma!</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css">

    <link href="style.css" rel="stylesheet" type="text/css">

    <script defer src="https://use.fontawesome.com/releases/v5.0.0/js/all.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  </head>
  <body>

<!-- 
Then find the friend with the greatest compatibility! -->

    <section class="hero is-info is-bold">
      <div class="hero-body">
        <div class="container">
          <h1 class="title">
            PretendFriend
          </h1>
          <h2 class="subtitle">
         Survey
          </h2>

  </section>




<section class="section">

  <div class="container">
    <h1 class="title">Section</h1>
    <h2 class="subtitle">
      A simple container to divide your page into <strong>sections</strong>, like the one you're currently reading
    </h2>
  </div>

  <div class="field">
    <label class="label">Name</label>
    <div class="control">
      <input class="input" type="text" placeholder="Text input" id="inputName">
    </div>
  </div>

  <div class="field">
    <label class="label">Image URL</label>
    <div class="control">
      <input class="input" type="text" placeholder="Text input" id="inputImage">
    </div>
  </div>

  <div class="field radio-questions">
  <!-- generated radio buttons -->
  </div>

  <a class="button is-danger submit">
    <span>Submit</span>
  </a>

</section>



<footer class="footer">
  <div class="container">
    <div class="content">
      <a class="button is-small is-info" href="https://github.com/jstudenski/pretendFriend" target="_blank">
        <span class="icon is-small">
          <i class="fab fa-github"></i>
        </span>
        <span>GitHub</span>
      </a>
      <a class="button is-small is-info" href="/api/friends">Friends API</a>
    </div>
  </div>
</footer>


<script type="text/javascript">

    // generate html
    var questions = ['Question 1', 'Second Question', 'Question 2'];

    for (var i = 0; i < questions.length; i++) {
      $('.radio-questions').append(questions[i] + '<br>');
      var name = 'question'+i;
      for (var r = 1; r < 6; r++) {

        var label = $('<label>')
          .addClass('radio')
          .html(r);
        var input = $('<input type="radio">')
          .attr('name', name)
          .attr('value', r)
          .appendTo(label);
        label.appendTo($('.radio-questions'));

        //$('.radio-questions').append('<label class="radio"><input type="radio" name="'+name+'" value="'+r+'">'+r+'</label>');


       }
      $('.radio-questions').append('<br>');
    }

    $(".submit").on("click", function(event) {
      event.preventDefault();

      var responses = [];
      for (var i = 0; i < questions.length; i++) {
        responses.push(parseInt($('input[name='+'question'+ i +']:checked').val()));
      }

      var newFriend = {
        name: $("#inputName").val().trim(),
        photo: $("#inputImage").val().trim(),
        scores: responses
      };

      console.log(newFriend);


      $.post("/api/friends", newFriend,
        function(data) {

          // If a table is available... tell user they are booked.
          if (data) {
            alert("Yay! You are officially booked!");
          }

          // If a table is available... tell user they on the waiting list.
          else {
            alert("Sorry you are on the wait list");
          }

          // Clear the form when submitting
          // $("#reserve-name").val("");
          // $("#reserve-phone").val("");
          // $("#reserve-email").val("");
          // $("#reserve-unique-id").val("");

        });

    });

</script>





  </body>
</html>